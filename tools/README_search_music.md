# Bilibili音乐搜索工具

## 功能概述

这是一个自动化工具，用于在Bilibili平台上搜索指定歌曲的最佳视频版本。该工具能够：

1. 根据歌曲名称和歌手名在Bilibili上进行搜索
2. 自动提取搜索结果中的视频信息（标题、时长、BV号）
3. 利用大模型AI分析所有搜索结果，智能选择最符合要求的视频
4. 支持单首歌曲搜索和批量歌曲处理两种模式

## 配置参数

工具使用了以下关键配置参数：

- `LLM_API_URL`：大模型API地址
- `LLM_API_KEY`：API密钥
- `LLM_MODEL_NAME`：使用的模型名称（默认为deepseek-chat）

## 使用方法

### 单首歌曲搜索（带歌手）：

```bash
python search_music.py "烟雨行舟" --artist "司南"
```

### 单首歌曲搜索（不带歌手）：

```bash
python search_music.py "烟雨行舟"
```

### 批量处理歌曲：

1. 创建NAMELIST.txt文件，每行格式为：`歌曲名,歌手名`（歌手名可选）
2. 执行命令：

```bash
python search_music.py NAMELIST
```

3. 结果将保存在BVLIST.txt文件中

## 技术路线

### 1. 搜索实现
- 使用`requests`库向Bilibili发送HTTP请求
- 构建合适的请求头模拟浏览器行为，避免被反爬机制拦截
- 支持自定义搜索关键词组合（歌名+歌手名/原唱）

### 2. 数据提取
工具采用多种数据提取策略，按优先级依次尝试：
- 从页面嵌入的JSON数据中提取视频信息
- 使用BeautifulSoup解析HTML结构提取视频信息
- 多种CSS选择器适配不同版本的Bilibili界面结构
- 使用正则表达式作为最后的提取手段
- 提取关键信息：视频标题、时长、BV号

### 3. 智能分析
- 调用大模型API（默认使用deepseek-chat）分析搜索结果
- 根据提供的视频信息，智能判断哪个视频最可能是完整歌曲版本
- 考虑因素：标题相关性、是否为完整版/片段、音质提示词等
- 返回单一BV号作为最佳选择结果

### 4. 批量处理
- 支持从NAMELIST.txt文件读取多首歌曲信息
- 对每首歌曲自动执行搜索、提取、分析流程
- 结果保存到BVLIST.txt文件，便于后续处理

## 注意事项

1. 依赖Python库：requests, BeautifulSoup4, argparse, urllib
2. 需要有效的大模型API密钥
3. 网页结构变化可能影响提取效果，但多层次提取策略会最大程度减少影响
4. 批量处理大量歌曲时，注意API调用频率和请求限制 